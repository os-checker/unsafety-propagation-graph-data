{
  "name": "core::fmt::Formatter::<'a>::write_formatted_parts",
  "span": "$library/core/src/fmt/mod.rs:2024:5: 2024:92",
  "src": "unsafe fn write_formatted_parts(&mut self, formatted: &numfmt::Formatted<'_>) -> Result {\n        unsafe fn write_bytes(buf: &mut dyn Write, s: &[u8]) -> Result {\n            // SAFETY: This is used for `numfmt::Part::Num` and `numfmt::Part::Copy`.\n            // It's safe to use for `numfmt::Part::Num` since every char `c` is between\n            // `b'0'` and `b'9'`, which means `s` is valid UTF-8. It's safe to use for\n            // `numfmt::Part::Copy` due to this function's precondition.\n            buf.write_str(unsafe { str::from_utf8_unchecked(s) })\n        }\n\n        if !formatted.sign.is_empty() {\n            self.buf.write_str(formatted.sign)?;\n        }\n        for part in formatted.parts {\n            match *part {\n                numfmt::Part::Zero(mut nzeroes) => {\n                    const ZEROES: &str = // 64 zeroes\n                        \"0000000000000000000000000000000000000000000000000000000000000000\";\n                    while nzeroes > ZEROES.len() {\n                        self.buf.write_str(ZEROES)?;\n                        nzeroes -= ZEROES.len();\n                    }\n                    if nzeroes > 0 {\n                        self.buf.write_str(&ZEROES[..nzeroes])?;\n                    }\n                }\n                numfmt::Part::Num(mut v) => {\n                    let mut s = [0; 5];\n                    let len = part.len();\n                    for c in s[..len].iter_mut().rev() {\n                        *c = b'0' + (v % 10) as u8;\n                        v /= 10;\n                    }\n                    // SAFETY: Per the precondition.\n                    unsafe {\n                        write_bytes(self.buf, &s[..len])?;\n                    }\n                }\n                // SAFETY: Per the precondition.\n                numfmt::Part::Copy(buf) => unsafe {\n                    write_bytes(self.buf, buf)?;\n                },\n            }\n        }\n        Ok(())\n    }"
}