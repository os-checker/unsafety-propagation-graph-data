{
  "name": "std::sys::pal::unix::stack_overflow::imp::init",
  "span": "$library/std/src/sys/pal/unix/stack_overflow.rs:152:5: 152:25",
  "src": "pub unsafe fn init() {\n        PAGE_SIZE.store(os::page_size(), Ordering::Relaxed);\n\n        let mut guard_page_range = unsafe { install_main_guard() };\n\n        // Even for panic=immediate-abort, installing the guard pages is important for soundness.\n        // That said, we do not care about giving nice stackoverflow messages via our custom\n        // signal handler, just exit early and let the user enjoy the segfault.\n        if cfg!(panic = \"immediate-abort\") {\n            return;\n        }\n\n        // SAFETY: assuming all platforms define struct sigaction as \"zero-initializable\"\n        let mut action: sigaction = unsafe { mem::zeroed() };\n        for &signal in &[SIGSEGV, SIGBUS] {\n            // SAFETY: just fetches the current signal handler into action\n            unsafe { sigaction(signal, ptr::null_mut(), &mut action) };\n            // Configure our signal handler if one is not already set.\n            if action.sa_sigaction == SIG_DFL {\n                if !NEED_ALTSTACK.load(Ordering::Relaxed) {\n                    // haven't set up our sigaltstack yet\n                    NEED_ALTSTACK.store(true, Ordering::Release);\n                    let handler = unsafe { make_handler(true) };\n                    MAIN_ALTSTACK.store(handler.data, Ordering::Relaxed);\n                    mem::forget(handler);\n\n                    if let Some(guard_page_range) = guard_page_range.take() {\n                        set_current_info(guard_page_range);\n                    }\n                }\n\n                action.sa_flags = SA_SIGINFO | SA_ONSTACK;\n                action.sa_sigaction = signal_handler\n                    as unsafe extern \"C\" fn(i32, *mut libc::siginfo_t, *mut libc::c_void)\n                    as sighandler_t;\n                // SAFETY: only overriding signals if the default is set\n                unsafe { sigaction(signal, &action, ptr::null_mut()) };\n            }\n        }\n    }"
}