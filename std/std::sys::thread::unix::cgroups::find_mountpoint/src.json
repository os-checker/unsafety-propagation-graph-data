{
  "name": "std::sys::thread::unix::cgroups::find_mountpoint",
  "span": "$library/std/src/sys/thread/unix.rs:817:5: 817:80",
  "src": "fn find_mountpoint(group_path: &Path) -> Option<(Cow<'static, str>, &Path)> {\n        let mut reader = File::open_buffered(\"/proc/self/mountinfo\").ok()?;\n        let mut line = String::with_capacity(256);\n        loop {\n            line.clear();\n            if reader.read_line(&mut line).ok()? == 0 {\n                break;\n            }\n\n            let line = line.trim();\n            let mut items = line.split(' ');\n\n            let sub_path = items.nth(3)?;\n            let mount_point = items.next()?;\n            let mount_opts = items.next_back()?;\n            let filesystem_type = items.nth_back(1)?;\n\n            if filesystem_type != \"cgroup\" || !mount_opts.split(',').any(|opt| opt == \"cpu\") {\n                // not a cgroup / not a cpu-controller\n                continue;\n            }\n\n            let sub_path = Path::new(sub_path).strip_prefix(\"/\").ok()?;\n\n            if !group_path.starts_with(sub_path) {\n                // this is a bind-mount and the bound subdirectory\n                // does not contain the cgroup this process belongs to\n                continue;\n            }\n\n            let trimmed_group_path = group_path.strip_prefix(sub_path).ok()?;\n\n            return Some((Cow::Owned(mount_point.to_owned()), trimmed_group_path));\n        }\n\n        None\n    }"
}