{
  "name": "std::sync::poison::rwlock::MappedRwLockWriteGuard::<'rwlock, T>::filter_map",
  "span": "$library/std/src/sync/poison/rwlock.rs:1074:5: 1080:19",
  "src": "pub fn filter_map<U, F>(\n        mut orig: Self,\n        f: F,\n    ) -> Result<MappedRwLockWriteGuard<'rwlock, U>, Self>\n    where\n        F: FnOnce(&mut T) -> Option<&mut U>,\n        U: ?Sized,\n    {\n        // SAFETY: the conditions of `RwLockWriteGuard::new` were satisfied when the original guard\n        // was created, and have been upheld throughout `map` and/or `filter_map`.\n        // The signature of the closure guarantees that it will not \"leak\" the lifetime of the\n        // reference passed to it. If the closure panics, the guard will be dropped.\n        match f(unsafe { orig.data.as_mut() }) {\n            Some(data) => {\n                let data = NonNull::from(data);\n                let orig = ManuallyDrop::new(orig);\n                Ok(MappedRwLockWriteGuard {\n                    data,\n                    inner_lock: orig.inner_lock,\n                    poison_flag: orig.poison_flag,\n                    poison_guard: orig.poison_guard.clone(),\n                    _variance: PhantomData,\n                })\n            }\n            None => Err(orig),\n        }\n    }"
}