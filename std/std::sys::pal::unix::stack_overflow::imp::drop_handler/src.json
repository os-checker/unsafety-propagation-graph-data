{
  "name": "std::sys::pal::unix::stack_overflow::imp::drop_handler",
  "span": "$library/std/src/sys/pal/unix/stack_overflow.rs:284:5: 284:56",
  "src": "pub unsafe fn drop_handler(data: *mut libc::c_void) {\n        if !data.is_null() {\n            let sigstack_size = sigstack_size();\n            let page_size = PAGE_SIZE.load(Ordering::Relaxed);\n            let disabling_stack = libc::stack_t {\n                ss_sp: ptr::null_mut(),\n                ss_flags: SS_DISABLE,\n                // Workaround for bug in macOS implementation of sigaltstack\n                // UNIX2003 which returns ENOMEM when disabling a stack while\n                // passing ss_size smaller than MINSIGSTKSZ. According to POSIX\n                // both ss_sp and ss_size should be ignored in this case.\n                ss_size: sigstack_size,\n            };\n            // SAFETY: we warned the caller this disables the alternate signal stack!\n            unsafe { sigaltstack(&disabling_stack, ptr::null_mut()) };\n            // SAFETY: We know from `get_stackp` that the alternate stack we installed is part of\n            // a mapping that started one page earlier, so walk back a page and unmap from there.\n            unsafe { munmap(data.sub(page_size), sigstack_size + page_size) };\n        }\n\n        delete_current_info();\n    }"
}