{
  "name": "alloc::rc::Rc::<T, A>::make_mut",
  "span": "$library/alloc/src/rc.rs:2065:5: 2065:47",
  "src": "pub fn make_mut(this: &mut Self) -> &mut T {\n        let size_of_val = size_of_val::<T>(&**this);\n\n        if Rc::strong_count(this) != 1 {\n            // Gotta clone the data, there are other Rcs.\n            *this = Rc::clone_from_ref_in(&**this, this.alloc.clone());\n        } else if Rc::weak_count(this) != 0 {\n            // Can just steal the data, all that's left is Weaks\n\n            // We don't need panic-protection like the above branch does, but we might as well\n            // use the same mechanism.\n            let mut in_progress: UniqueRcUninit<T, A> =\n                UniqueRcUninit::new(&**this, this.alloc.clone());\n            unsafe {\n                // Initialize `in_progress` with move of **this.\n                // We have to express this in terms of bytes because `T: ?Sized`; there is no\n                // operation that just copies a value based on its `size_of_val()`.\n                ptr::copy_nonoverlapping(\n                    ptr::from_ref(&**this).cast::<u8>(),\n                    in_progress.data_ptr().cast::<u8>(),\n                    size_of_val,\n                );\n\n                this.inner().dec_strong();\n                // Remove implicit strong-weak ref (no need to craft a fake\n                // Weak here -- we know other Weaks can clean up for us)\n                this.inner().dec_weak();\n                // Replace `this` with newly constructed Rc that has the moved data.\n                ptr::write(this, in_progress.into_rc());\n            }\n        }\n        // This unsafety is ok because we're guaranteed that the pointer\n        // returned is the *only* pointer that will ever be returned to T. Our\n        // reference count is guaranteed to be 1 at this point, and we required\n        // the `Rc<T>` itself to be `mut`, so we're returning the only possible\n        // reference to the allocation.\n        unsafe { &mut this.ptr.as_mut().value }\n    }"
}