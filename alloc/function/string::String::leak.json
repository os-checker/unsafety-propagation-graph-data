{
  "name": "string::String::leak",
  "safe": true,
  "callees": {
    "vec::Vec::<T, A>::leak": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Consumes and leaks the `Vec`, returning a mutable reference to the contents,\n `&'a mut [T]`.\n\n Note that the type `T` must outlive the chosen lifetime `'a`. If the type\n has only static references, or none at all, then this may be chosen to be\n `'static`.\n\n As of Rust 1.57, this method does not reallocate or shrink the `Vec`,\n so the leaked allocation may include unused capacity that is not part\n of the returned slice.\n\n This function is mainly useful for data that lives for the remainder of\n the program's life. Dropping the returned reference will cause a memory\n leak.\n\n # Examples\n\n Simple usage:\n\n ```\n let x = vec![1, 2, 3];\n let static_ref: &'static mut [usize] = x.leak();\n static_ref[0] += 1;\n assert_eq!(static_ref, &[2, 2, 3]);\n # // FIXME(https://github.com/rust-lang/miri/issues/3670):\n # // use -Zmiri-disable-leak-check instead of unleaking in tests meant to leak.\n # drop(unsafe { Box::from_raw(static_ref) });\n ```\n",
      "adt": {
        "vec::Vec": "MutableAsArgument"
      }
    },
    "core::str::from_utf8_unchecked_mut": {
      "safe": false,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Converts a slice of bytes to a string slice without checking\n that the string contains valid UTF-8; mutable version.\n\n This is an alias to [`str::from_utf8_unchecked_mut`].\n\n See the immutable version, [`from_utf8_unchecked()`] for documentation and safety requirements.\n\n # Examples\n\n Basic usage:\n\n ```\n use std::str;\n\n let mut heart = vec![240, 159, 146, 150];\n let heart = unsafe { str::from_utf8_unchecked_mut(&mut heart) };\n\n assert_eq!(\"ðŸ’–\", heart);\n ```\n",
      "adt": {}
    }
  },
  "adts": {
    "vec::Vec": [
      "Plain"
    ],
    "string::String": [
      "Unknown([Field(0, Ty { id: 1639, kind: RigidTy(Adt(AdtDef(DefId { id: 2824, name: \"vec::Vec\" }), GenericArgs([Type(Ty { id: 93, kind: RigidTy(Uint(U8)) }), Type(Ty { id: 17, kind: RigidTy(Adt(AdtDef(DefId { id: 2583, name: \"alloc::Global\" }), GenericArgs([]))) })]))) })])",
      "Plain"
    ]
  },
  "path": {
    "type": "Local",
    "path": "alloc::string::String::leak"
  },
  "span": "/home/gh-zjp-CN/.rustup/toolchains/nightly-2025-12-06-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/string.rs:2202:5: 2205:6",
  "src": "pub fn leak<'a>(self) -> &'a mut str {\n        let slice = self.vec.leak();\n        unsafe { from_utf8_unchecked_mut(slice) }\n    }",
  "mir": "fn string::String::leak(_1: string::String) -> &mut str {\n    let mut _0: &mut str;\n    let  _2: &mut [u8];\n    let mut _3: vec::Vec<u8>;\n    debug self => _1;\n    debug slice => _2;\n    bb0: {\n        StorageLive(_3);\n        _3 = move (_1.0: vec::Vec<u8>);\n        _2 = vec::Vec::<u8>::leak::<'_>(move _3) -> [return: bb1, unwind unreachable];\n    }\n    bb1: {\n        StorageDead(_3);\n        _0 = core::str::from_utf8_unchecked_mut(_2) -> [return: bb2, unwind unreachable];\n    }\n    bb2: {\n        return;\n    }\n}\n",
  "doc": " Consumes and leaks the `String`, returning a mutable reference to the contents,\n `&'a mut str`.\n\n The caller has free choice over the returned lifetime, including `'static`. Indeed,\n this function is ideally used for data that lives for the remainder of the program's life,\n as dropping the returned reference will cause a memory leak.\n\n It does not reallocate or shrink the `String`, so the leaked allocation may include unused\n capacity that is not part of the returned slice. If you want to discard excess capacity,\n call [`into_boxed_str`], and then [`Box::leak`] instead. However, keep in mind that\n trimming the capacity may result in a reallocation and copy.\n\n [`into_boxed_str`]: Self::into_boxed_str\n\n # Examples\n\n ```\n let x = String::from(\"bucket\");\n let static_ref: &'static mut str = x.leak();\n assert_eq!(static_ref, \"bucket\");\n # // FIXME(https://github.com/rust-lang/miri/issues/3670):\n # // use -Zmiri-disable-leak-check instead of unleaking in tests meant to leak.\n # drop(unsafe { Box::from_raw(static_ref) });\n ```\n",
  "tags": {
    "tags": [],
    "spec": {},
    "docs": []
  }
}