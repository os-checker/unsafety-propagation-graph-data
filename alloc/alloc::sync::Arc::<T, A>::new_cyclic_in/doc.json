{
  "name": "alloc::sync::Arc::<T, A>::new_cyclic_in",
  "span": "$library/alloc/src/sync.rs:882:5: 884:37",
  "doc": " Constructs a new `Arc<T, A>` in the given allocator while giving you a `Weak<T, A>` to the allocation,\n to allow you to construct a `T` which holds a weak pointer to itself.\n\n Generally, a structure circularly referencing itself, either directly or\n indirectly, should not hold a strong reference to itself to prevent a memory leak.\n Using this function, you get access to the weak pointer during the\n initialization of `T`, before the `Arc<T, A>` is created, such that you can\n clone and store it inside the `T`.\n\n `new_cyclic_in` first allocates the managed allocation for the `Arc<T, A>`,\n then calls your closure, giving it a `Weak<T, A>` to this allocation,\n and only afterwards completes the construction of the `Arc<T, A>` by placing\n the `T` returned from your closure into the allocation.\n\n Since the new `Arc<T, A>` is not fully-constructed until `Arc<T, A>::new_cyclic_in`\n returns, calling [`upgrade`] on the weak reference inside your closure will\n fail and result in a `None` value.\n\n # Panics\n\n If `data_fn` panics, the panic is propagated to the caller, and the\n temporary [`Weak<T>`] is dropped normally.\n\n # Example\n\n See [`new_cyclic`]\n\n [`new_cyclic`]: Arc::new_cyclic\n [`upgrade`]: Weak::upgrade\n"
}