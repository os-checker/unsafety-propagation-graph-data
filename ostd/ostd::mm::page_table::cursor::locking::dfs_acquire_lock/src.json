{
  "name": "ostd::mm::page_table::cursor::locking::dfs_acquire_lock",
  "span": "ostd/src/mm/page_table/cursor/locking.rs:170:1: 175:2",
  "src": "fn dfs_acquire_lock<C: PageTableConfig>(\n    guard: &dyn InAtomicMode,\n    cur_node: &mut PageTableGuard<'_, C>,\n    cur_node_va: Vaddr,\n    va_range: Range<Vaddr>,\n) {\n    debug_assert!(!*cur_node.stray_mut());\n\n    let cur_level = cur_node.level();\n    if cur_level == 1 {\n        return;\n    }\n\n    let idx_range = dfs_get_idx_range::<C>(cur_level, cur_node_va, &va_range);\n    for i in idx_range {\n        let child = cur_node.entry(i);\n        match child.to_ref() {\n            ChildRef::PageTable(pt) => {\n                let mut pt_guard = pt.lock(guard);\n                let child_node_va = cur_node_va + i * page_size::<C>(cur_level);\n                let child_node_va_end = child_node_va + page_size::<C>(cur_level);\n                let va_start = va_range.start.max(child_node_va);\n                let va_end = va_range.end.min(child_node_va_end);\n                dfs_acquire_lock(guard, &mut pt_guard, child_node_va, va_start..va_end);\n                let _ = ManuallyDrop::new(pt_guard);\n            }\n            ChildRef::None | ChildRef::Frame(_, _, _) => {}\n        }\n    }\n}"
}