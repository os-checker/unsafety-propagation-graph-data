{
  "name": "ostd::mm::kspace::kvirt_area::KVirtArea::map_frames",
  "span": "ostd/src/mm/kspace/kvirt_area.rs:99:5: 104:14",
  "src": "pub fn map_frames<T: AnyFrameMeta + ?Sized>(\n        area_size: usize,\n        map_offset: usize,\n        frames: impl Iterator<Item = Frame<T>>,\n        prop: PageProperty,\n    ) -> Self {\n        assert!(area_size.is_multiple_of(PAGE_SIZE));\n        assert!(map_offset.is_multiple_of(PAGE_SIZE));\n\n        let range = KVIRT_AREA_ALLOCATOR.alloc(area_size).unwrap();\n        let cursor_range = range.start + map_offset..range.end;\n\n        let page_table = KERNEL_PAGE_TABLE.get().unwrap();\n        let preempt_guard = disable_preempt();\n        let mut cursor = page_table\n            .cursor_mut(&preempt_guard, &cursor_range)\n            .unwrap();\n\n        for frame in frames.into_iter() {\n            // SAFETY: The constructor of the `KVirtArea` has already ensured\n            // that this mapping does not affect kernel's memory safety.\n            unsafe { cursor.map(MappedItem::Tracked(Frame::from_unsized(frame), prop)) }\n                .expect(\"Failed to map frame in a new `KVirtArea`\");\n        }\n\n        Self { range }\n    }"
}