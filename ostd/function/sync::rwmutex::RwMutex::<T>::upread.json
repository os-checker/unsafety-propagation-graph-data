{
  "name": "sync::rwmutex::RwMutex::<T>::upread",
  "safe": true,
  "callees": {
    "sync::wait::WaitQueue::wait_until": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Waits until some condition is met.\n\n This method takes a closure that tests a user-given condition.\n The method only returns if the condition returns `Some(_)`.\n A waker thread should first make the condition `Some(_)`, then invoke the\n `wake`-family method. This ordering is important to ensure that waiter\n threads do not lose any wakeup notifications.\n\n By taking a condition closure, this wait-wakeup mechanism becomes\n more efficient and robust.\n",
      "adt": {
        "sync::wait::WaitQueue": "ImmutableAsArgument"
      }
    }
  },
  "adts": {
    "sync::wait::WaitQueue": [
      "Ref"
    ],
    "sync::rwmutex::RwMutex": [
      "DerefVariantField(VariantIdx(None)-FieldIdx(Some(1)))",
      "Ref"
    ],
    "sync::rwmutex::RwMutexUpgradeableGuard": [
      "Plain"
    ]
  },
  "path": {
    "type": "Local",
    "path": "ostd::sync::rwmutex::RwMutex::<T>::upread"
  },
  "span": "ostd/src/sync/rwmutex.rs:150:5: 152:6",
  "src": "pub fn upread(&self) -> RwMutexUpgradeableGuard<'_, T> {\n        self.queue.wait_until(|| self.try_upread())\n    }",
  "mir": "fn sync::rwmutex::RwMutex::<T>::upread(_1: &sync::rwmutex::RwMutex<T>) -> sync::rwmutex::RwMutexUpgradeableGuard<'_, T> {\n    let mut _0: sync::rwmutex::RwMutexUpgradeableGuard<'_, T>;\n    let mut _2: &sync::wait::WaitQueue;\n    let mut _3: {closure@ostd/src/sync/rwmutex.rs:151:31: 151:33};\n    debug self => _1;\n    bb0: {\n        StorageLive(_2);\n        _2 = &((*_1).1: sync::wait::WaitQueue);\n        StorageLive(_3);\n        _3 = {closure@ostd/src/sync/rwmutex.rs:151:31: 151:33}(_1);\n        _0 = sync::wait::WaitQueue::wait_until::<{closure@ostd/src/sync/rwmutex.rs:151:31: 151:33}, sync::rwmutex::RwMutexUpgradeableGuard<'_, T>>(move _2, move _3) -> [return: bb1, unwind unreachable];\n    }\n    bb1: {\n        StorageDead(_3);\n        StorageDead(_2);\n        return;\n    }\n}\n",
  "doc": " Acquires a upread mutex and sleep until it can be acquired.\n\n The calling thread will sleep until there are no writers or upreaders present.\n The implementation of [`WaitQueue`] guarantees the order in which other concurrent\n readers or writers waiting simultaneously will acquire the mutex.\n\n Upreader will not block new readers until it tries to upgrade. Upreader\n and reader do not differ before invoking the upgread method. However,\n only one upreader can exist at any time to avoid deadlock in the\n upgread method.\n",
  "tags": {
    "tags": [],
    "spec": {},
    "docs": []
  }
}