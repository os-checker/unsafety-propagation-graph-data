{
  "name": "arch::irq::ipi::HwCpuId::read_current",
  "safe": true,
  "callees": {
    "arch::kernel::apic::get_or_init": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Returns a reference to the local APIC instance of the current CPU.\n\n The reference to the APIC instance will not outlive the given\n [`PinCurrentCpu`] guard and the APIC instance does not implement\n [`Sync`], so it is safe to assume that the APIC instance belongs\n to the current CPU. Note that interrupts are not disabled, so the\n APIC instance may be accessed concurrently by interrupt handlers.\n\n At the first time the function is called, the local APIC instance\n is initialized and enabled if it was not enabled beforehand.\n\n # Examples\n\n ```rust\n use ostd::{\n     arch::x86::kernel::apic,\n     task::disable_preempt,\n };\n\n let preempt_guard = disable_preempt();\n let apic = apic::get_or_init(&preempt_guard as _);\n\n let ticks = apic.timer_current_count();\n apic.set_timer_init_count(0);\n ```\n",
      "adt": {}
    },
    "arch::kernel::apic::Apic::id": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": "",
      "adt": {}
    }
  },
  "adts": {
    "arch::irq::ipi::HwCpuId": [
      "Plain"
    ]
  },
  "path": {
    "type": "Local",
    "path": "ostd::arch::irq::ipi::HwCpuId::read_current"
  },
  "span": "ostd/src/arch/x86/irq/ipi.rs:16:5: 21:6",
  "src": "pub(crate) fn read_current(guard: &dyn PinCurrentCpu) -> Self {\n        use crate::arch::kernel::apic;\n\n        let apic = apic::get_or_init(guard);\n        Self(apic.id())\n    }",
  "mir": "fn arch::irq::ipi::HwCpuId::read_current(_1: &dyn cpu::id::current::PinCurrentCpu) -> arch::irq::ipi::HwCpuId {\n    let mut _0: arch::irq::ipi::HwCpuId;\n    let  _2: &dyn arch::kernel::apic::Apic;\n    let mut _3: u32;\n    debug guard => _1;\n    debug apic => _2;\n    bb0: {\n        _2 = arch::kernel::apic::get_or_init(_1) -> [return: bb1, unwind unreachable];\n    }\n    bb1: {\n        StorageLive(_3);\n        _3 = <dyn arch::kernel::apic::Apic as arch::kernel::apic::Apic>::id(_2) -> [return: bb2, unwind unreachable];\n    }\n    bb2: {\n        _0 = HwCpuId(move _3);\n        StorageDead(_3);\n        return;\n    }\n}\n",
  "doc": "",
  "tags": {
    "tags": [],
    "spec": {},
    "docs": []
  }
}