{
  "name": "mm::kspace::activate_kernel_page_table",
  "safe": false,
  "callees": {
    "spin::once::Once::<T, R>::get": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Returns a reference to the inner value if the [`Once`] has been initialized.\n",
      "adt": {}
    },
    "core::option::Option::<T>::expect": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Returns the contained [`Some`] value, consuming the `self` value.\n\n # Panics\n\n Panics if the value is a [`None`] with a custom panic message provided by\n `msg`.\n\n # Examples\n\n ```\n let x = Some(\"value\");\n assert_eq!(x.expect(\"fruits are healthy\"), \"value\");\n ```\n\n ```should_panic\n let x: Option<&str> = None;\n x.expect(\"fruits are healthy\"); // panics with `fruits are healthy`\n ```\n\n # Recommended Message Style\n\n We recommend that `expect` messages are used to describe the reason you\n _expect_ the `Option` should be `Some`.\n\n ```should_panic\n # let slice: &[u8] = &[];\n let item = slice.get(0)\n     .expect(\"slice should not be empty\");\n ```\n\n **Hint**: If you're having trouble remembering how to phrase expect\n error messages remember to focus on the word \"should\" as in \"env\n variable should be set by blah\" or \"the given binary should be available\n and executable by the current user\".\n\n For more detail on expect message styles and the reasoning behind our\n recommendation please refer to the section on [\"Common Message\n Styles\"](../../std/error/index.html#common-message-styles) in the [`std::error`](../../std/error/index.html) module docs.\n",
      "adt": {}
    },
    "mm::page_table::PageTable::<C>::first_activate_unchecked": {
      "safe": false,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": "",
      "adt": {
        "mm::page_table::PageTable": "ImmutableAsArgument"
      }
    },
    "arch::mm::tlb_flush_all_including_global": {
      "safe": true,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Flush all TLB entries, including global-page entries.\n",
      "adt": {}
    }
  },
  "adts": {
    "spin::once::Once": [
      "Ref"
    ],
    "core::option::Option": [
      "Plain"
    ],
    "mm::page_table::PageTable": [
      "Ref"
    ]
  },
  "path": {
    "type": "Local",
    "path": "ostd::mm::kspace::activate_kernel_page_table"
  },
  "span": "ostd/src/mm/kspace/mod.rs:282:1: 291:2",
  "src": "pub unsafe fn activate_kernel_page_table() {\n    let kpt = KERNEL_PAGE_TABLE\n        .get()\n        .expect(\"The kernel page table is not initialized yet\");\n    // SAFETY: the kernel page table is initialized properly.\n    unsafe {\n        kpt.first_activate_unchecked();\n        crate::arch::mm::tlb_flush_all_including_global();\n    }\n}",
  "mir": "fn mm::kspace::activate_kernel_page_table() -> () {\n    let mut _0: ();\n    let  _1: &mm::page_table::PageTable<mm::kspace::KernelPtConfig>;\n    let mut _2: core::option::Option<&mm::page_table::PageTable<mm::kspace::KernelPtConfig>>;\n    let mut _3: &spin::once::Once<mm::page_table::PageTable<mm::kspace::KernelPtConfig>>;\n    let mut _4: &str;\n    let  _5: ();\n    let  _6: ();\n    debug kpt => _1;\n    bb0: {\n        StorageLive(_2);\n        StorageLive(_3);\n        _3 = {alloc1275: &spin::once::Once<mm::page_table::PageTable<mm::kspace::KernelPtConfig>>};\n        _2 = spin::once::Once::<mm::page_table::PageTable<mm::kspace::KernelPtConfig>>::get(move _3) -> [return: bb1, unwind unreachable];\n    }\n    bb1: {\n        StorageDead(_3);\n        StorageLive(_4);\n        _4 = \"The kernel page table is not initialized yet\";\n        _1 = core::option::Option::<&mm::page_table::PageTable<mm::kspace::KernelPtConfig>>::expect(move _2, move _4) -> [return: bb2, unwind unreachable];\n    }\n    bb2: {\n        StorageDead(_4);\n        StorageDead(_2);\n        _5 = mm::page_table::PageTable::<mm::kspace::KernelPtConfig>::first_activate_unchecked(_1) -> [return: bb3, unwind unreachable];\n    }\n    bb3: {\n        _6 = arch::mm::tlb_flush_all_including_global() -> [return: bb4, unwind unreachable];\n    }\n    bb4: {\n        return;\n    }\n}\n",
  "doc": " Activates the kernel page table.\n\n All address translation of symbols in the boot sections must be manually\n done from now on.\n\n # Safety\n\n This function must only be called once per CPU.\n",
  "tags": {
    "tags": [],
    "spec": {},
    "docs": []
  }
}