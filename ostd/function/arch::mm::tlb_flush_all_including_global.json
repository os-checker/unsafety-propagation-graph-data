{
  "name": "arch::mm::tlb_flush_all_including_global",
  "safe": true,
  "callees": {
    "x86_64::registers::control::x86_64::<impl x86_64::registers::control::Cr4>::update": {
      "safe": false,
      "tags": {
        "tags": [],
        "spec": {},
        "docs": []
      },
      "doc": " Updates CR4 flags.\n\n Preserves the value of reserved fields.\n\n ## Safety\n\n This function is unsafe because it's possible to violate memory\n safety through it, e.g. by overwriting the physical address extension\n flag.\n",
      "adt": {}
    }
  },
  "adts": {},
  "path": {
    "type": "Local",
    "path": "ostd::arch::mm::tlb_flush_all_including_global"
  },
  "span": "ostd/src/arch/x86/mm/mod.rs:107:1: 120:2",
  "src": "pub(crate) fn tlb_flush_all_including_global() {\n    // SAFETY: updates to CR4 here only change the global-page bit, the side effect\n    // is only to invalidate the TLB, which doesn't affect the memory safety.\n    unsafe {\n        // To invalidate all entries, including global-page\n        // entries, disable global-page extensions (CR4.PGE=0).\n        x86_64::registers::control::Cr4::update(|cr4| {\n            *cr4 -= x86_64::registers::control::Cr4Flags::PAGE_GLOBAL;\n        });\n        x86_64::registers::control::Cr4::update(|cr4| {\n            *cr4 |= x86_64::registers::control::Cr4Flags::PAGE_GLOBAL;\n        });\n    }\n}",
  "mir": "fn arch::mm::tlb_flush_all_including_global() -> () {\n    let mut _0: ();\n    let  _1: ();\n    let  _2: ();\n    bb0: {\n        _1 = x86_64::registers::control::x86_64::<impl x86_64::registers::control::Cr4>::update::<{closure@ostd/src/arch/x86/mm/mod.rs:113:49: 113:54}>(ZeroSized: {closure@ostd/src/arch/x86/mm/mod.rs:113:49: 113:54}) -> [return: bb1, unwind unreachable];\n    }\n    bb1: {\n        _2 = x86_64::registers::control::x86_64::<impl x86_64::registers::control::Cr4>::update::<{closure@ostd/src/arch/x86/mm/mod.rs:116:49: 116:54}>(ZeroSized: {closure@ostd/src/arch/x86/mm/mod.rs:116:49: 116:54}) -> [return: bb2, unwind unreachable];\n    }\n    bb2: {\n        return;\n    }\n}\n",
  "doc": " Flush all TLB entries, including global-page entries.\n",
  "tags": {
    "tags": [],
    "spec": {},
    "docs": []
  }
}