{
  "name": "ostd::sync::rwmutex::RwMutex",
  "constructors": [
    "ostd::sync::rwmutex::RwMutex::<T>::new"
  ],
  "access_self_as_arg": {
    "read": [
      "ostd::<sync::rwmutex::RwMutex<T> as core::fmt::Debug>::fmt",
      "ostd::sync::rwmutex::RwMutex::<T>::read",
      "ostd::sync::rwmutex::RwMutex::<T>::try_read",
      "ostd::sync::rwmutex::RwMutex::<T>::try_upread",
      "ostd::sync::rwmutex::RwMutex::<T>::try_write",
      "ostd::sync::rwmutex::RwMutex::<T>::upread",
      "ostd::sync::rwmutex::RwMutex::<T>::write"
    ],
    "write": [
      "ostd::sync::rwmutex::RwMutex::<T>::get_mut"
    ],
    "other": []
  },
  "access_self_as_locals": {
    "read": [
      "ostd::<sync::rwmutex::RwMutexReadGuard<'_, T> as core::ops::Deref>::deref",
      "ostd::<sync::rwmutex::RwMutexReadGuard<'_, T> as core::ops::Drop>::drop",
      "ostd::<sync::rwmutex::RwMutexUpgradeableGuard<'_, T> as core::ops::Deref>::deref",
      "ostd::<sync::rwmutex::RwMutexUpgradeableGuard<'_, T> as core::ops::Drop>::drop",
      "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::Deref>::deref",
      "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::DerefMut>::deref_mut",
      "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::Drop>::drop",
      "ostd::sync::rwmutex::RwMutexUpgradeableGuard::<'a, T>::try_upgrade",
      "ostd::sync::rwmutex::RwMutexUpgradeableGuard::<'a, T>::upgrade",
      "ostd::sync::rwmutex::RwMutexWriteGuard::<'a, T>::try_downgrade"
    ],
    "write": [],
    "other": [
      "ostd::sync::rwmutex::RwMutex::<T>::new"
    ]
  },
  "access_field": [
    {
      "read": [
        "ostd::<sync::rwmutex::RwMutexReadGuard<'_, T> as core::ops::Drop>::drop",
        "ostd::<sync::rwmutex::RwMutexUpgradeableGuard<'_, T> as core::ops::Drop>::drop",
        "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::Drop>::drop",
        "ostd::sync::rwmutex::RwMutex::<T>::try_read",
        "ostd::sync::rwmutex::RwMutex::<T>::try_upread",
        "ostd::sync::rwmutex::RwMutex::<T>::try_write",
        "ostd::sync::rwmutex::RwMutexUpgradeableGuard::<'a, T>::try_upgrade",
        "ostd::sync::rwmutex::RwMutexUpgradeableGuard::<'a, T>::upgrade",
        "ostd::sync::rwmutex::RwMutexWriteGuard::<'a, T>::try_downgrade"
      ],
      "write": [],
      "other": []
    },
    {
      "read": [
        "ostd::<sync::rwmutex::RwMutexReadGuard<'_, T> as core::ops::Drop>::drop",
        "ostd::<sync::rwmutex::RwMutexUpgradeableGuard<'_, T> as core::ops::Drop>::drop",
        "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::Drop>::drop",
        "ostd::sync::rwmutex::RwMutex::<T>::read",
        "ostd::sync::rwmutex::RwMutex::<T>::upread",
        "ostd::sync::rwmutex::RwMutex::<T>::write"
      ],
      "write": [],
      "other": []
    },
    {
      "read": [
        "ostd::<sync::rwmutex::RwMutex<T> as core::fmt::Debug>::fmt",
        "ostd::<sync::rwmutex::RwMutexReadGuard<'_, T> as core::ops::Deref>::deref",
        "ostd::<sync::rwmutex::RwMutexUpgradeableGuard<'_, T> as core::ops::Deref>::deref",
        "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::Deref>::deref",
        "ostd::<sync::rwmutex::RwMutexWriteGuard<'_, T> as core::ops::DerefMut>::deref_mut"
      ],
      "write": [
        "ostd::sync::rwmutex::RwMutex::<T>::get_mut"
      ],
      "other": []
    }
  ],
  "span": "ostd/src/sync/rwmutex.rs:87:1: 87:30",
  "src": "pub struct RwMutex<T: ?Sized>",
  "kind": "Struct",
  "doc_adt": " A mutex that provides data access to either one writer or many readers.\n\n # Overview\n\n This mutex allows for multiple readers, or at most one writer to access\n at any point in time. The writer of this mutex has exclusive access to\n modify the underlying data, while the readers are allowed shared and\n read-only access.\n\n The writing and reading portions cannot be active simultaneously, when\n one portion is in progress, the other portion will sleep. This is\n suitable for scenarios where the mutex is expected to be held for a\n period of time, which can avoid wasting CPU resources.\n\n This implementation provides the upgradeable read mutex (`upread mutex`).\n The `upread mutex` can be upgraded to write mutex atomically, useful in\n scenarios where a decision to write is made after reading.\n\n The type parameter `T` represents the data that this mutex is protecting.\n It is necessary for `T` to satisfy [`Send`] to be shared across tasks and\n [`Sync`] to permit concurrent access via readers. The [`Deref`] method (and\n [`DerefMut`] for the writer) is implemented for the RAII guards returned\n by the locking methods, which allows for the access to the protected data\n while the mutex is held.\n\n # Usage\n The mutex can be used in scenarios where data needs to be read frequently\n but written to occasionally.\n\n Use `upread mutex` in scenarios where related checking is performed before\n modification to effectively avoid deadlocks and improve efficiency.\n\n # Safety\n\n Avoid using `RwMutex` in an interrupt context, as it may result in sleeping\n and never being awakened.\n\n # Examples\n\n ```\n use ostd::sync::RwMutex;\n\n let mutex = RwMutex::new(5)\n\n // many read mutexes can be held at once\n {\n     let r1 = mutex.read();\n     let r2 = mutex.read();\n     assert_eq!(*r1, 5);\n     assert_eq!(*r2, 5);\n     \n     // Upgradeable read mutex can share access to data with read mutexes\n     let r3 = mutex.upread();\n     assert_eq!(*r3, 5);\n     drop(r1);\n     drop(r2);\n     // read mutexes are dropped at this point\n\n     // An upread mutex can only be upgraded successfully after all the\n     // read mutexes are released, otherwise it will spin-wait.\n     let mut w1 = r3.upgrade();\n     *w1 += 1;\n     assert_eq!(*w1, 6);\n }   // upread mutex are dropped at this point\n\n {   \n     // Only one write mutex can be held at a time\n     let mut w2 = mutex.write();\n     *w2 += 1;\n     assert_eq!(*w2, 7);\n }   // write mutex is dropped at this point\n ```\n",
  "variant_fields": {
    "VariantIdx(None)-FieldIdx(Some(0))": {
      "name": "lock",
      "doc": " The internal representation of the mutex state is as follows:\n - **Bit 63:** Writer mutex.\n - **Bit 62:** Upgradeable reader mutex.\n - **Bit 61:** Indicates if an upgradeable reader is being upgraded.\n - **Bits 60-0:** Reader mutex count.\n"
    },
    "VariantIdx(None)-FieldIdx(Some(1))": {
      "name": "queue",
      "doc": " Threads that fail to acquire the mutex will sleep on this waitqueue.\n"
    },
    "VariantIdx(None)-FieldIdx(Some(2))": {
      "name": "val",
      "doc": ""
    }
  }
}