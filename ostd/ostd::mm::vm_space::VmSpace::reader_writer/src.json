{
  "name": "ostd::mm::vm_space::VmSpace::reader_writer",
  "span": "ostd/src/mm/vm_space.rs:207:5: 211:66",
  "src": "pub fn reader_writer(\n        &self,\n        vaddr: Vaddr,\n        len: usize,\n    ) -> Result<(VmReader<'_, Fallible>, VmWriter<'_, Fallible>)> {\n        if current_page_table_paddr() != self.pt.root_paddr() {\n            return Err(Error::AccessDenied);\n        }\n\n        if vaddr.saturating_add(len) > MAX_USERSPACE_VADDR {\n            return Err(Error::AccessDenied);\n        }\n\n        // SAFETY: The memory range is in user space, as checked above.\n        let reader = unsafe { VmReader::<Fallible>::from_user_space(vaddr as *const u8, len) };\n\n        // `VmWriter` is neither `Sync` nor `Send`, so it will not live longer than the current\n        // task. This ensures that the correct page table is activated during the usage period of\n        // the `VmWriter`.\n        //\n        // SAFETY: The memory range is in user space, as checked above.\n        let writer = unsafe { VmWriter::<Fallible>::from_user_space(vaddr as *mut u8, len) };\n\n        Ok((reader, writer))\n    }"
}